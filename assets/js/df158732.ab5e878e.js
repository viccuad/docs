"use strict";(self.webpackChunkkubewarden_docusaurus=self.webpackChunkkubewarden_docusaurus||[]).push([[9748],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>y});var i=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=i.createContext({}),c=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=c(e.components);return i.createElement(s.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},m=i.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=c(n),m=r,y=p["".concat(s,".").concat(m)]||p[m]||d[m]||a;return n?i.createElement(y,o(o({ref:t},u),{},{components:n})):i.createElement(y,o({ref:t},u))}));function y(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,o=new Array(a);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[p]="string"==typeof e?e:r,o[1]=l;for(var c=2;c<a;c++)o[c]=n[c];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8155:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>d,frontMatter:()=>a,metadata:()=>l,toc:()=>c});var i=n(7462),r=(n(7294),n(3905));const a={sidebar_label:"Limitations",title:"Audit Scanner - Limitations"},o=void 0,l={unversionedId:"explanations/audit-scanner/limitations",id:"explanations/audit-scanner/limitations",title:"Audit Scanner - Limitations",description:"Supported event types",source:"@site/docs/explanations/audit-scanner/limitations.md",sourceDirName:"explanations/audit-scanner",slug:"/explanations/audit-scanner/limitations",permalink:"/explanations/audit-scanner/limitations",draft:!1,editUrl:"https://github.com/kubewarden/docs/edit/main/docs/explanations/audit-scanner/limitations.md",tags:[],version:"current",lastUpdatedAt:1694791075,formattedLastUpdatedAt:"Sep 15, 2023",frontMatter:{sidebar_label:"Limitations",title:"Audit Scanner - Limitations"},sidebar:"docs",previous:{title:"What's it?",permalink:"/explanations/audit-scanner/"},next:{title:"Policy Reports",permalink:"/explanations/audit-scanner/policy-reports"}},s={},c=[{value:"Supported event types",id:"supported-event-types",level:2},{value:"Policies relying on user and user group information",id:"policies-relying-on-user-and-user-group-information",level:2},{value:"Policies relying on external data",id:"policies-relying-on-external-data",level:2},{value:"Policies targeting <code>*</code>",id:"policies-targeting-",level:2}],u={toc:c},p="wrapper";function d(e){let{components:t,...n}=e;return(0,r.kt)(p,(0,i.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"supported-event-types"},"Supported event types"),(0,r.kt)("p",null,"Policies can inspect ",(0,r.kt)("inlineCode",{parentName:"p"},"CREATE"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"UPDATE"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"DELETE")," events."),(0,r.kt)("p",null,"The audit scanner cannot simulate ",(0,r.kt)("inlineCode",{parentName:"p"},"UPDATE")," events, as it doesn't know exactly\nwhich part of the resource needs to be changed in a meaningful way."),(0,r.kt)("p",null,"Because of that, policy interested only in ",(0,r.kt)("inlineCode",{parentName:"p"},"UPDATE")," events will be ignored by\nthe audit scanner."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"The audit-scanner v1.7.0 release supports only ",(0,r.kt)("inlineCode",{parentName:"p"},"CREATE")," events. ",(0,r.kt)("inlineCode",{parentName:"p"},"DELETE")," ones\nwill be handled in the near future.")),(0,r.kt)("h2",{id:"policies-relying-on-user-and-user-group-information"},"Policies relying on user and user group information"),(0,r.kt)("p",null,"Each Kubernetes admission request object contains information about which user\n(or ServiceAccount) initiated the event, and to which group they belong."),(0,r.kt)("p",null,"All the events simulated by the audit scanner are originated by the same hard\ncoded user and group. Because of that, policies that rely on these values to\nmake their decisions will not produce meaningful results."),(0,r.kt)("p",null,"For these cases, the policy should be configured to be skipped from the audit\nchecks."),(0,r.kt)("h2",{id:"policies-relying-on-external-data"},"Policies relying on external data"),(0,r.kt)("p",null,"Policies can request and use external data when performing an evaluation. These\npolicies can be evaluated by the audit checks, but their outcome can change\nover time depending on the external data."),(0,r.kt)("h2",{id:"policies-targeting-"},"Policies targeting ",(0,r.kt)("inlineCode",{parentName:"h2"},"*")),(0,r.kt)("p",null,"Policies targeting any kind of Kubernetes resources are not being evaluated for\nnow. Because of that they are going to be ignored by the audit scanner."))}d.isMDXComponent=!0}}]);